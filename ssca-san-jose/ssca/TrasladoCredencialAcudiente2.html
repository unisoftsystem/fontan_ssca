<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>RECARGUE MONETARIO DE CREDENCIALES</title>
    <meta name="author" content="Unisoft">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="css/styles.css">
    <link href="css/style.css" rel="stylesheet" type="text/css" />
    <!-- Latest compiled and minified CSS -->
    <!-- Optional theme -->
    <!-- Latest compiled and minified JavaScript -->
    <script type="text/javascript" src="js/funtions.js"></script>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link href="css/style.css" rel="stylesheet" type="text/css" />
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="js/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="js/ConexionWebService.js"></script>
    <script src="js/photobooth.js"></script>
	<script type="text/javascript" src="js/qr/grid.js"></script>
    <script type="text/javascript" src="js/qr/version.js"></script>
    <script type="text/javascript" src="js/qr/detector.js"></script>
    <script type="text/javascript" src="js/qr/formatinf.js"></script>
    <script type="text/javascript" src="js/qr/errorlevel.js"></script>
    <script type="text/javascript" src="js/qr/bitmat.js"></script>
    <script type="text/javascript" src="js/qr/datablock.js"></script>
    <script type="text/javascript" src="js/qr/bmparser.js"></script>
    <script type="text/javascript" src="js/qr/datamask.js"></script>
    <script type="text/javascript" src="js/qr/rsdecoder.js"></script>
    <script type="text/javascript" src="js/qr/gf256poly.js"></script>
    <script type="text/javascript" src="js/qr/gf256.js"></script>
    <script type="text/javascript" src="js/qr/decoder.js"></script>
    <script type="text/javascript" src="js/qr/qrcode.js"></script>
    <script type="text/javascript" src="js/qr/findpat.js"></script>
    <script type="text/javascript" src="js/qr/alignpat.js"></script>
    <script type="text/javascript" src="js/qr/databr.js"></script>
    <script src="js/responsive-nav.js"></script>
    <script type="text/javascript">
		$(document).ready(function() {
	
			// for webcam support
			$('#example').photobooth().on("image", function(event, dataUrl) {
				qrCodeDecoder(dataUrl);
			});
		
			$('#button').click(function() {
				$('.trigger').trigger('click');
			});
			
			qrcode.callback = showInfo;
		});
		
		// decode the img
		function qrCodeDecoder(dataUrl) {
			qrcode.decode(dataUrl);
		}
		
		// show info from qr code
		function showInfo(data) {
			$("#txtUsuario").val(data);
			EnviarDatos({usuario: data}, "ActionConsultarUsuarioPorId.php", "CONSULTARUSUARIOREEMPLAZOC");
			console.log(data);
		}
	   
	</script>
    <style>
		* {
			padding:0;
			margin:0;
		}
		body{
			background-color:#FFF;
		}
		
	
    @media screen { 
        div.footer { 
            position: fixed; 
            bottom: 0; 
        } 
    } 
    @media print { 
        div.footer { 
            position: fixed; 
            bottom: 0; 
        } 
    } 
	input{
		border-radius:7px;
		width:200px;
	}
	button{
		border-radius:7px;
		width:150px;
	}
	</style>
  </head>
  <body>

   <header>
      <a href="#" class="logo" data-scroll><img src="images/logo.png" width="100" border="0" style="position:absolute"></a>
      <nav class="nav-collapse">
        <ul>
          <li class="menu-item active"><a href="ConsultaSaldo2.html" data-scroll>CONSULTA DE SALDO</a></li>
          <li class="menu-item active"><a href="ConsultaMovimientosAcudiente2.html" data-scroll>CONSULTA DE MOVIMIENTOS</a></li>
          <li class="menu-item active"><a href="RecargueMonetarioAcudiente2.html" data-scroll>RECARGUE MONETARIO DE CREDENCIALES</a></li>
          <li class="menu-item active"><a href="#" data-scroll>TRASLADO DE FONDOS ENTRE TARJETAS</a></li>
          <li class="menu-item active"><a href="LoginAcudientes.html" data-scroll>SALIR</a></li>
        </ul>
      </nav>
    </header>
    <div style="margin-top:100px" align="center">
    	<table align="center">
            <tr>
                <td><label for="">Origen</label></td>
                <td>&nbsp;</td>        
            </tr>
            <tr>
                <td><label for="selectIdCredencial">Id de Usuario:</label></td>
                <td><select id="selectIdCredencial" name="selectIdCredencial"></select></td>           
                <td rowspan="7" valign="top" style="padding-left:10px">
                    <img src="" id="imageFoto" name="imageFoto" width="128px" height="128px"/>
                </td>    
            </tr>
            <tr>
                <td><label for="txtPrimerApellido">Primer Apellido:</label></td>
                <td><input type="text" name="txtPrimerApellido" id="txtPrimerApellido" disabled/></td>        
            </tr>
            <tr>
                <td><label for="txtSegundoApellido">Segundo Apellido:</label></td>
                <td><input type="text" name="txtSegundoApellido" id="txtSegundoApellido" disabled/></td>        
            </tr>
            <tr>
                <td><label for="txtPrimerNombre">Primer Nombre:</label></td>
                <td><input type="text" name="txtPrimerNombre" id="txtPrimerNombre" disabled/></td>        
            </tr>
            <tr>
                <td><label for="txtSegundoNombre">Segundo Nombre:</label></td>
                <td><input type="text" name="txtSegundoNombre" id="txtSegundoNombre" disabled/></td>        
            </tr>
            <tr>
                <td><label for="txtRecarga">Saldo:</label></td>
                <td><input type="text" name="txtRecarga" id="txtRecarga" disabled/></td>        
            </tr>
            
            <tr>
                <td colspan="3" height="20px">&nbsp;</td>        
            </tr>
            
            <tr>
                <td><label for="">Destino</label></td>
                <td>&nbsp;</td>        
            </tr>
        
            <tr>
                <td><label for="selectUsuario">Id de Usuario:</label></td>
                <td><select id="selectUsuario" name="selectUsuario"></select></td>  
                <td rowspan="7" valign="top" style="padding-left:10px">
                    <img src="" id="imageFotoDestino" name="imageFotoDestino" width="128px" height="128px"/>
                </td>           
            </tr>
            <tr>
                <td><label for="txtPrimerApellidoDestino">Primer Apellido:</label></td>
                <td><input type="text" name="txtPrimerApellidoDestino" id="txtPrimerApellidoDestino" disabled/></td>        
            </tr>
            <tr>
                <td><label for="txtSegundoApellidoDestino">Segundo Apellido:</label></td>
                <td><input type="text" name="txtSegundoApellidoDestino" id="txtSegundoApellidoDestino" disabled/></td>        
            </tr>
            <tr>
                <td><label for="txtPrimerNombreDestino">Primer Nombre:</label></td>
                <td><input type="text" name="txtPrimerNombreDestino" id="txtPrimerNombreDestino" disabled/></td>        
            </tr>
            <tr>
                <td><label for="txtSegundoNombreDestino">Segundo Nombre:</label></td>
                <td><input type="text" name="txtSegundoNombreDestino" id="txtSegundoNombreDestino" disabled/></td>        
            </tr>
            <tr>
                <td><label for="txtRecargaDestino">Saldo:</label></td>
                <td><input type="text" name="txtRecargaDestino" id="txtRecargaDestino" disabled/></td>        
            </tr>
            <tr>
                <td><label for="txtValorRecargaDestino">Valor de recargue:</label></td>
                <td><input type="number" name="txtValorRecargaDestino" id="txtValorRecargaDestino" min="1" value="1"/></td>        
            </tr>
            <!--<tr>
                <td><label for="txtDirección">Direcci&oacute;n:</label></td>
                <td><input type="text" name="txtDirección" id="txtDireccion" disabled/></td>        
            </tr>
            <tr>
                <td><label for="txtTelefono1">Tel&eacute;fono 1:</label></td>
                <td><input type="tel" name="txtTelefono1" id="txtTelefono1" disabled/></td>        
            </tr>-->
            <tr>
                <td>&nbsp;</td>
                <td><button type="button" id="btnRecargue" name="btnRecargue">Realizar Recargue</button></td>        
            </tr>
           
            
            
        </table>
        <div id="divResultado">

		</div>
    </div>
	<div class="footer" align="center"><h1 align="center">&nbsp;</h1></div>
   	<script>
		$(document).ready(function() {
			// Actualizamos el fondo al cargar la pagina
			
			var screenWidth = $(window).width();
			var screenHeight = $(window).height();
			var dimension = screenWidth + "px " + screenHeight + "px";
			
			$( "body" ).css({
			  "background-size": dimension
			});
			$(window).bind("resize", function() {
				// Y tambien cada vez que se redimensione el navegador
				var screenWidth = $(window).width();
				var screenHeight = $(window).height();
				var dimension = screenWidth + "px " + screenHeight + "px";
				
				$( "body" ).css({
				  "background-size": dimension
				});
			});
			
			
		});
		
		/*
			Fecha: 			Octubre 22 de 2015
			Descripcion: 	Script para enviar los datos al webservice para que los inserte en la base de datos
		
		*/
		
		//Valor guardado cuando se cierra un popup y se concreto una operación
		var opcionSeleccionar = "";
			
		//Capturar evento del boton crear
		$("#btnRecargue").click(function(e) {
			//Se obtienen los datos a enviar		
			var usuarioOrigen = $("#selectIdCredencial").val();
			var usuarioDestino = $("#selectUsuario").val();
			var saldo = $("#txtValorRecargaDestino").val();
			var usuarioSesion = localStorage.getItem("usuario"); 
			/*
				Descripcion: Obtener fecha y hora para registrar movimientos
			*/
			var date = new Date();
			var dia = date.getDate();
			var mes = (date.getMonth() + 1);
			var year = date.getFullYear();
			
			
			if(dia < 10) {
				dia = '0' + dia;
			} 
			
			if(mes < 10) {
				mes = '0' + mes;
			} 
			
			var fechaActual = year + "-" + mes + "-" + dia;
			var horaActual = date.getHours() + ":" + date.getMinutes() + ":" + date.getSeconds(); 
			
			//Se guardan los datos en un JSON
			var usuario = {
				usuarioOrigen: usuarioOrigen,
				usuarioDestino: usuarioDestino,
				usuarioSesion: usuarioSesion,
				saldo: saldo,
				fecha: fechaActual,
				hora: horaActual
			}		
			
			//Se envian a la funcion que realiza la conexion al werbservice y genera una respuesta que se guarda en un localstorage
			EnviarDatos(usuario, "ActionTrasladoFondos.php", "PROCESARRECAUDO");
			
			$("#txtPrimerApellido").val("");
			$("#txtSegundoApellido").val("");
			$("#txtPrimerNombre").val("");
			$("#txtSegundoNombre").val("");
			$("#txtRecarga").val("");
			$("#txtUsuario").val("");
			$("#txtValorRecarga").val("1");
			
		});
		
		/*
			Fecha: 23 de Octubre de 2015
			Descripcion: Evento para capturar la existencia del usuario en la base de datos al quitar el focus del campo de texto de usuario
		*/
		$("#selectIdCredencial").change (function(e) {
			
			if($("#selectIdCredencial").val() != "Seleccione"){
				var usuarioSesion = localStorage.getItem("usuario"); 
				var usuarioConsultar = $("#selectIdCredencial").val();
				
				//Se envian a la funcion que realiza la conexion al werbservice y genera una respuesta que se guarda en un localstorage
				EnviarDatos({usuario: usuarioConsultar, acudiente: usuarioSesion}, "ActionConsultarUsuarioPorIdAcudiente.php", "CONSULTARUSUARIOSALDO");
			}
		});
		
		$("#selectIdCredencial").change (function(e) {
			
			if($("#selectIdCredencial").val() != "Seleccione"){
				var usuarioSesion = localStorage.getItem("usuario"); 
				var usuarioConsultar = $("#selectIdCredencial").val();
				
				//Se envian a la funcion que realiza la conexion al werbservice y genera una respuesta que se guarda en un localstorage
				EnviarDatos({usuario: usuarioConsultar, acudiente: usuarioSesion}, "ActionConsultarUsuarioPorIdAcudiente.php", "CONSULTARUSUARIOSALDO");
			}
		});
		
		$("#selectUsuario").change (function(e) {
			
			if($("#selectUsuario").val() != "Seleccione"){
				var usuarioSesion = localStorage.getItem("usuario"); 
				var usuarioConsultar = $("#selectUsuario").val();
				
				//Se envian a la funcion que realiza la conexion al werbservice y genera una respuesta que se guarda en un localstorage
				EnviarDatos({usuario: usuarioConsultar, acudiente: usuarioSesion}, "ActionConsultarUsuarioPorIdAcudiente.php", "CONSULTARUSUARIOTRASLADO");
			}
		});
    </script>
    <script src="js/fastclick.js"></script>
    <script src="js/scroll.js"></script>
    <script src="js/fixed-responsive-nav.js"></script>
  </body>
</html>